<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Readymade Cloth Store - POC</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding-top: 70px; }
    .invoice-container { max-width: 800px; margin: auto; }
    .invoice-header { text-align: center; margin-bottom: 20px; }
    .invoice-header h2 { margin-bottom: 0; }
    .invoice-footer { text-align: center; margin-top: 30px; font-size: 14px; }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Cloth Store POC</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link active" href="#home">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#inventory">Inventory</a></li>
          <li class="nav-item"><a class="nav-link" href="#billing">Billing</a></li>
          <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Home -->
  <section id="home" class="container text-center">
    <h1 class="mb-3">Welcome to Readymade Cloth Store</h1>
    <p class="lead">Demo POC with Inventory Management & Billing System</p>
  </section>

  <!-- Inventory Section -->
  <section id="inventory" class="container mt-5">
    <h2>Inventory Management</h2>
    <form id="itemForm" class="row g-3 mb-3">
      <div class="col-md-3"><input type="text" id="itemName" class="form-control" placeholder="Item Name" required></div>
      <div class="col-md-3"><input type="number" id="itemPrice" class="form-control" placeholder="Price ₹" required></div>
      <div class="col-md-3"><input type="number" id="itemStock" class="form-control" placeholder="Stock Qty" required></div>
      <div class="col-md-3"><button type="submit" class="btn btn-primary w-100">Add Item</button></div>
    </form>
    <table class="table table-bordered table-hover">
      <thead class="table-dark">
        <tr><th>ID</th><th>Name</th><th>Price (₹)</th><th>Stock</th><th>Actions</th></tr>
      </thead>
      <tbody id="inventoryTable"></tbody>
    </table>
  </section>

  <!-- Billing Section -->
  <section id="billing" class="container mt-5">
    <h2>Billing</h2>
    <form id="billingForm" class="row g-3 mb-3">
      <div class="col-md-4">
        <select id="billItem" class="form-select" required></select>
      </div>
      <div class="col-md-4">
        <input type="number" id="billQty" class="form-control" placeholder="Quantity" required>
      </div>
      <div class="col-md-4">
        <button type="submit" class="btn btn-success w-100">Add to Bill</button>
      </div>
    </form>
    <table class="table table-bordered">
      <thead class="table-secondary">
        <tr><th>Item</th><th>Qty</th><th>Rate (₹)</th><th>Amount (₹)</th></tr>
      </thead>
      <tbody id="billTable"></tbody>
    </table>
    <button id="generateBill" class="btn btn-danger">Generate Bill (New Tab)</button>
  </section>

  <!-- About -->
  <section id="about" class="container mt-5">
    <h2>About</h2>
    <p>This is a demo POC for a Readymade Cloth Store, built with HTML, Bootstrap, and Vanilla JS. Data is stored in-memory using JSON arrays.</p>
  </section>

  <script>
    // Sample JSON Data
    let inventory = [
      { id: 1, name: "Shirt", price: 500, stock: 20 },
      { id: 2, name: "Jeans", price: 1200, stock: 15 },
      { id: 3, name: "Kurta", price: 800, stock: 10 }
    ];
    let billItems = [];
    let itemId = 4;

    // Render Inventory
    function renderInventory() {
      const table = document.getElementById("inventoryTable");
      const select = document.getElementById("billItem");
      table.innerHTML = "";
      select.innerHTML = "<option value=''>-- Select Item --</option>";
      inventory.forEach(item => {
        table.innerHTML += `
          <tr>
            <td>${item.id}</td>
            <td>${item.name}</td>
            <td>${item.price}</td>
            <td>${item.stock}</td>
            <td>
              <button class="btn btn-sm btn-warning" onclick="editItem(${item.id})">Edit</button>
              <button class="btn btn-sm btn-danger" onclick="deleteItem(${item.id})">Delete</button>
            </td>
          </tr>`;
        select.innerHTML += `<option value="${item.id}">${item.name}</option>`;
      });
    }

    // Add Item
    document.getElementById("itemForm").addEventListener("submit", e => {
      e.preventDefault();
      let name = document.getElementById("itemName").value;
      let price = parseFloat(document.getElementById("itemPrice").value);
      let stock = parseInt(document.getElementById("itemStock").value);
      inventory.push({ id: itemId++, name, price, stock });
      renderInventory();
      e.target.reset();
    });

    // Delete Item
    function deleteItem(id) {
      inventory = inventory.filter(item => item.id !== id);
      renderInventory();
    }

    // Edit Item
    function editItem(id) {
      const item = inventory.find(i => i.id === id);
      document.getElementById("itemName").value = item.name;
      document.getElementById("itemPrice").value = item.price;
      document.getElementById("itemStock").value = item.stock;
      deleteItem(id);
    }

    // Add to Bill
    document.getElementById("billingForm").addEventListener("submit", e => {
      e.preventDefault();
      let id = parseInt(document.getElementById("billItem").value);
      let qty = parseInt(document.getElementById("billQty").value);
      let item = inventory.find(i => i.id === id);
      if (item && qty <= item.stock) {
        billItems.push({ ...item, qty });
        item.stock -= qty;
        renderInventory();
        renderBill();
      }
      e.target.reset();
    });

    // Render Bill Table
    function renderBill() {
      const table = document.getElementById("billTable");
      table.innerHTML = "";
      billItems.forEach(b => {
        table.innerHTML += `<tr>
          <td>${b.name}</td><td>${b.qty}</td><td>${b.price}</td><td>${b.qty * b.price}</td>
        </tr>`;
      });
    }

    // Generate Invoice in New Tab
    document.getElementById("generateBill").addEventListener("click", () => {
      let subtotal = billItems.reduce((sum, b) => sum + b.qty * b.price, 0);
      let cgst = subtotal * 0.09;
      let sgst = subtotal * 0.09;
      let total = subtotal + cgst + sgst;
      let billNo = Math.floor(Math.random() * 100000);

      let invoiceHTML = `
        <html><head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <title>Invoice</title></head>
        <body class="p-5">
          <div class="invoice-container">
            <div class="invoice-header">
              <h2>Readymade Cloth Store</h2>
              <p>123 Market Road, Mumbai - 400001<br>Phone: +91 9876543210</p>
            </div>
            <p><strong>Bill No:</strong> ${billNo} | <strong>Date:</strong> ${new Date().toLocaleDateString()}</p>
            <table class="table table-bordered">
              <thead class="table-secondary">
                <tr><th>#</th><th>Item</th><th>Qty</th><th>Rate (₹)</th><th>Amount (₹)</th></tr>
              </thead>
              <tbody>
                ${billItems.map((b,i)=>`
                  <tr>
                    <td>${i+1}</td><td>${b.name}</td><td>${b.qty}</td><td>${b.price}</td><td>${b.qty*b.price}</td>
                  </tr>`).join("")}
              </tbody>
            </table>
            <p class="text-end"><strong>Subtotal:</strong> ₹${subtotal.toFixed(2)}</p>
            <p class="text-end"><strong>CGST (9%):</strong> ₹${cgst.toFixed(2)}</p>
            <p class="text-end"><strong>SGST (9%):</strong> ₹${sgst.toFixed(2)}</p>
            <h4 class="text-end">Grand Total: ₹${total.toFixed(2)}</h4>
            <div class="invoice-footer">Thank you for shopping with us!</div>
            <button onclick="window.print()" class="btn btn-primary mt-3">Print Bill</button>
          </div>
        </body></html>
      `;

      let invoiceWindow = window.open("", "_blank");
      invoiceWindow.document.write(invoiceHTML);
      invoiceWindow.document.close();
    });

    // Initial Render
    renderInventory();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
